<!DOCTYPE html>
<html lang="en-us">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
  <meta property="og:title" content=" Custom Field control implemented as a User Control &middot;  Clint Simon" />
  
  <meta name="theme-color" content="#af200a" />
 
  <meta property="og:site_name" content="Clint Simon" />
  <meta property="og:url" content="http://clintsimon.com/post/2008/2008-03-13-Custom-Field-control-implemented-as-a-User-Control/" />
  
  
  <meta property="og:type" content="article" />
  
  <meta property="og:article:author" content="https://facebook.com/csim74" />
  
  <meta property="og:article:published_time" content="2008-03-13T08:00:00-08:00" />
  
  <meta property="og:article:tag" content="SharePoint" />
  
  <meta property="og:article:tag" content="Programming" />
  
  

  <title>
     Custom Field control implemented as a User Control &middot;  Clint Simon
  </title>

  <link rel="stylesheet" href="http://clintsimon.com/css/bootstrap.min.css" />
  <link rel="stylesheet" href="http://clintsimon.com/css/main.css" />
  <link rel="stylesheet" href="http://clintsimon.com/css/font-awesome.min.css" />
  <link rel="stylesheet" href="http://clintsimon.com/css/github.css" />
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400" type="text/css">
  <link rel="shortcut icon" href="http://clintsimon.com/images/favicon.ico" />
  <link rel="apple-touch-icon" href="http://clintsimon.com/images/apple-touch-icon.png" />
  
</head>
<body>
    
    <header class="global-header">
    <section class="header-text">
      <h1><a href="http://clintsimon.com/">Clint Simon</a></h1>
      
      <div class="tag-line">
        Find a way.
      </div>
      
      <div class="sns-links hidden-print">
  
  
  <a href="https://twitter.com/clintsim" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  <a href="https://facebook.com/csim74" target="_blank">
    <i class="fa fa-facebook"></i>
  </a>
  
  
  <a href="https://github.com/csim" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  <a href="https://linkedin.com/in/clintsimon" target="_blank">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  <a href="/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>

      
      <a href="http://clintsimon.com/" class="btn-header btn-back hidden-xs"><i class="fa fa-home"></i>&nbsp; Home</a>
      
      <a href="/tags" class="btn-header btn-topics hidden-xs"><i class="fa fa-tags"></i>&nbsp; Topics</a>
      <a href="/post" class="btn-header btn-archive hidden-xs"><i class="fa fa-archive"></i>&nbsp; Archive</a>
    </section>
  </header>
  <main class="container">


<article>
  <header>
    <h1 class="text-primary">Custom Field control implemented as a User Control</h1>
    <div class="post-meta clearfix">
      <div class="post-date pull-left">
        Posted on
        <time datetime="2008-03-13T08:00:00-08:00">
          Mar 13, 2008
        </time>
      </div>
      <div class="pull-right">
        
        <span class="post-tag small"><a href="http://clintsimon.com//tags/sharepoint">#SharePoint</a></span>
        
        <span class="post-tag small"><a href="http://clintsimon.com//tags/programming">#Programming</a></span>
        
      </div>
    </div>
  </header>
  <section>
    <p>When creating custom controls it is often must easier to create a control using
the &ldquo;User Control&rdquo; development model instead of the &ldquo;Server Control&rdquo; model. <a href="http://msdn.microsoft.com/en-us/library/zt27tfhy.aspx">Server controls</a> generally have a more &ldquo;low level&rdquo; feel and dictate that the developer build the control&rsquo;s rendering from scratch. Either by building a control tree or by constructing the rendered output in code.</p>

<p>Alternatively <a href="http://msdn.microsoft.com/en-us/library/y6wb1a0e.aspx">user controls</a> have nice separation of code and presentation by virtue of having a markup file (.ascx) and a code behind file; much like a standard aspx page. User controls can be created and developed using the same standard approaches and processes that we all know and love from the aspx page model.</p>

<p>When implementing a custom field control for SharePoint, the development experience can be streamlined to a large degree by utilizing a user control. Traditionally field controls are created using the server control model but with a few tricks you can implement a custom field control with a user control.</p>

<p>First, here is the base class used for the field control. It has a virtual property used to set the user control path. A property override for the value of the field which is read from the user control. On initialization it loads the user control and sets the context.</p>

<script src="https://gist.github.com/csim/10280829.js?file=BaseFieldControl.cs"></script>

<p>Here&rsquo;s an example field control subclass. This class simply specifies the user control path and let&rsquo;s the base class handle all the details of loading the user control and setting the context. This is the server control that you will embed into you page layouts.</p>

<script src="https://gist.github.com/csim/10280829.js?file=UserControlFieldBase.cs"></script>

<p>Next, is the abstract base class for the user control. This class provides a property for a reference to the parent field control and an abstract property for the field value. The field control property is important because our user control will need to know all the information about the field it is attached to. This includes the SPField context and control mode among other things.</p>

<script src="https://gist.github.com/csim/10280829.js?file=SPFieldUserControlBase.cs"></script>

<p>Lastly you can create a user control that inherits from the SPFieldUserControlBase class and implement the specific UI that is necessary for you field control to function. See my pervious post on how to create a custom field control for further direction on creating field controls from scratch.
This technique also you to have easiest possible development process while leveraging the SharePoint field control infrastructure. Any questions or comments, please let me know!</p>

  </section>
  <footer>
    
    <hr/>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname = 'clintsimon';
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
    
  </footer>
</article>

  </main>
  <footer class="container global-footer">
    <div class="copyright-note pull-left">
      &copy; Copyright
    </div>
    <div class="sns-links hidden-print">
  
  
  <a href="https://twitter.com/clintsim" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  <a href="https://facebook.com/csim74" target="_blank">
    <i class="fa fa-facebook"></i>
  </a>
  
  
  <a href="https://github.com/csim" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  <a href="https://linkedin.com/in/clintsimon" target="_blank">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  <a href="/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>

  </footer>

  <script src="http://clintsimon.com/js/highlight.pack.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-25860409-1', 'auto');
    ga('send', 'pageview');
  </script>
  
  
</body>
</html>

