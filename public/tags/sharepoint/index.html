<!DOCTYPE html>
<html lang="en-us">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
  <meta property="og:title" content=" Sharepoint &middot;  Clint Simon" />
  
  <meta name="theme-color" content="#af200a" />
 
  <meta property="og:site_name" content="Clint Simon" />
  <meta property="og:url" content="http://clintsimon.com/tags/sharepoint/" />
  
  
  <meta property="og:type" content="website" />
  

  <title>
     Sharepoint &middot;  Clint Simon
  </title>

  <link rel="stylesheet" href="http://clintsimon.com/css/bootstrap.min.css" />
  <link rel="stylesheet" href="http://clintsimon.com/css/main.css" />
  <link rel="stylesheet" href="http://clintsimon.com/css/font-awesome.min.css" />
  <link rel="stylesheet" href="http://clintsimon.com/css/github.css" />
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400" type="text/css">
  <link rel="shortcut icon" href="http://clintsimon.com/images/favicon.ico" />
  <link rel="apple-touch-icon" href="http://clintsimon.com/images/apple-touch-icon.png" />
  
</head>
<body>
    
    <header class="global-header">
    <section class="header-text">
      <h1><a href="http://clintsimon.com/">Clint Simon</a></h1>
      
      <div class="tag-line">
        Find a way.
      </div>
      
      <div class="sns-links hidden-print">
  
  
  <a href="https://twitter.com/clintsim" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  <a href="https://facebook.com/csim74" target="_blank">
    <i class="fa fa-facebook"></i>
  </a>
  
  
  <a href="https://github.com/csim" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  <a href="https://linkedin.com/in/clintsimon" target="_blank">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  <a href="/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>

      
      <a href="http://clintsimon.com/" class="btn-header btn-back hidden-xs"><i class="fa fa-home"></i>&nbsp; Home</a>
      
      <a href="/tags" class="btn-header btn-topics hidden-xs"><i class="fa fa-tags"></i>&nbsp; Topics</a>
      <a href="/post" class="btn-header btn-archive hidden-xs"><i class="fa fa-archive"></i>&nbsp; Archive</a>
    </section>
  </header>
  <main class="container">

<section class="article-list">
  <h1>Sharepoint</h1>
  
  <hr/>
  <article>
  <header>
    <h2><a href="http://clintsimon.com/post/2013/2013-11-25-embed-video-sharepoint/">Embed video in SharePoint</a></h2>
    <div class="post-meta clearfix">
      <div class="post-date pull-left">
        Posted on
        <time datetime="2013-11-25T08:00:00-08:00">
          Nov 25, 2013
        </time>
      </div>
    </div>
  </header>
  <div>
    <p>I recently had to embed a full-screen video into a SharePoint 2010 page (don&rsquo;t ask). Here is the solution using the default silverlight embeded video player which is packaged with SharePoint 2010.</p>

<script src="https://gist.github.com/csim/10283199.js"></script>

  </div>
  
  <footer>
    <ul class="pager">
      <li class="next"><a href="http://clintsimon.com/post/2013/2013-11-25-embed-video-sharepoint/">Comments <span aria-hidden="true">&raquo;</span></a></li>
    </ul>
  </footer>
  
</article>

  
  <hr/>
  <article>
  <header>
    <h2><a href="http://clintsimon.com/post/2008/2008-09-12-Using-the-SharePoint-content-database-as-a-cache/">Using the SharePoint content database as a cache</a></h2>
    <div class="post-meta clearfix">
      <div class="post-date pull-left">
        Posted on
        <time datetime="2008-09-12T08:00:00-08:00">
          Sep 12, 2008
        </time>
      </div>
    </div>
  </header>
  <div>
    <p>Data caching is a core concept in the web dominated world that we live in. The premise is that we should not have to go back to retrieve data from a data store for every single web request when the data is unchanged, thereby sharing data across web requests. This offers huge performance advantages because all latency related to data fetching, query processing and transmission is eliminated for requests that use the same data. In the SharePoint world this can be a very valuable technique when querying MOSS page libraries or any data stored in the content database. For high traffic sites, the performance of the SPQuery or SPSiteDataQuery api is not acceptable when executing queries for each request.</p>

<p>The most common data caching implementation is using the HttpContext.Cache collection. This is an ASP.NET facility that allows as an in-memory object cache associated with the ASP.NET application domain (w3wp.exe). For SharePoint applications this cache works great when caching can be scoped to the HttpContext. For applications that need caching that is not scoped based on the HttpContext it is necessary find a different solution. The most common case non-HttpContext caching would be any instance where you are consuming data outside of the ASP.NET context such as SPTimer jobs, stsadm commands, winform applications or console applications. For these cases it is not possible to use the HttpContext cache.</p>

<p>There are a few potential solutions to this problem including using the <a href="http://weblogs.asp.net/pjohnson/archive/2006/02/06/437559.aspx">HttpRuntime static cache</a>, but the best solution (in my opinion) is to use the SPSite instance as a data cache. The idea is that by using the SPSite.RootWeb.AllProperties hashtable, we can store cached data into the content database for later retrieval. This solves the HttpContext problem because for any application to operate it will need to have a SPSite object to provided context for it&rsquo;s operation no matter where it may be running. Because the SPSite object provides context, the data cache is always available.</p>

<p>Here&rsquo;s the class signatures for my implementation of SPSite data caching. By creating a subclass from this base you can implement application independent caching of any data type. <a href="http://code.google.com/p/rapid-tools/source/browse/trunk/Rapid.Tools/Domain/RapidCachedDataAdapterBase.cs">The full implement can be found here</a>.</p>

<script src="https://gist.github.com/csim/10284798.js?file=RapidCachedDataAdapterBase.cs"></script>

<p>Notes:</p>

<ul>
<li><strong>GetNativeData() is the only method you must override when creating a subclass.</strong> GetNaiveData() provides data from the native datastore to feed the cache, it is called any time that data needs to be retrieved from the native data store.</li>
<li><strong>Serialization to a string is necessary for all cached data types.</strong> Since SPSite.RootWeb.AllProperties accepts only limited data types (date, int and string), it is necessary for us to convert our data into a string. My default the base class uses the standard XmlSerializer class. If you are caching a data type that is not xml serializable (such as Hashtable, Dictionary &amp; DataTable) then you need to implement the Serialize() and Deserialize() method within your subclass. You can choose to serialize your data any way you like as long as it can be represented as a string.</li>
<li><strong>The CacheTimeoutMinutes property determines how long the cached data will live.</strong> An automatic refresh will be triggered when the timeout period expires. The timeout period is set to 20 minutes by default but you can override this in your subclass.</li>
<li><strong>You need to handle cache invalidation when native data changes.</strong> Cache invalidation is supported by the base class, but it is only called automatically if the cache expires due to a cache timeout. You will need to identify the cases where you would like to invalidate the cache and call InvalidateCache() at the appropriated time. Usually you would invalidate the cache when you detect that data has changed, such as when a user changes a list item. In this case you would need to have a feature receiver to detect the change and call InvalidateCache().</li>
<li><strong>The CachedData property used for data access.</strong> The CachedData property will either load the cache or retrieve the cache depending on the situation. You can use the CachedData property as the single access for data.</li>
<li><strong>Using SPSite.RootWeb.AllProperties does carry a cost.</strong> Because we need to load and manipulate an SPSite object, there is an implied cost associated with this approach. Anytime SPSite is loaded or saved SharePoint needs to communicate with the content database and that takes cycles. This is in sharp contrast to the HttpContext.Cache approach where all data is stored in memory. To mitigate this cost the base class uses the HttpContext.Items collection to cache data for each http request. This means that the SPSite object will only be loaded used once per request.</li>
</ul>

<p>Here&rsquo;s a sample subclass:</p>

<script src="https://gist.github.com/csim/10284798.js?file=RapidCachedDataAdapterBase2.cs"></script>

  </div>
  
  <footer>
    <ul class="pager">
      <li class="next"><a href="http://clintsimon.com/post/2008/2008-09-12-Using-the-SharePoint-content-database-as-a-cache/">Read more <span aria-hidden="true">&raquo;</span></a></li>
    </ul>
  </footer>
  
</article>

  
  <hr/>
  <article>
  <header>
    <h2><a href="http://clintsimon.com/post/2008/2008-08-16-Customize-the-web.config-with-a-SharePoint-customization/">Customize the web.config with a SharePoint XML customization</a></h2>
    <div class="post-meta clearfix">
      <div class="post-date pull-left">
        Posted on
        <time datetime="2008-08-16T08:00:00-08:00">
          Aug 16, 2008
        </time>
      </div>
    </div>
  </header>
  <div>
    

<p>It is possible to manipulate the web.config file globally by using a little known feature in SharePoint that allows developers to describe a set of changes by using an XML customization file. In fact, both SharePoint and MOSS use this mechanism to publish web.config changes when a web application is created.</p>

<h3 id="create-the-customization-file:9a44789face19d6856f93f2254ea0d9c">Create the customization file</h3>

<p>The customization file is used by SharePoint to apply changes to the web.config file when a web application is created. Any changes that are inside the customization file will be applied to all web applications globally. This method of customization does not work for cases where you would like to apply web.config changes to only a specific web application.</p>

<p>In this case I am adding a custom HttpModule to the web.config file. The web.config node will be appended as a child to the configuration/system.web/httpModules node. The id attribute needs to be unique. Everything inside the add node will be appened as a child to the node specified in the path attribute.</p>

<script src="https://gist.github.com/csim/10282788.js"></script>

<h3 id="copy-the-customization-file-to-the-web-front-end:9a44789face19d6856f93f2254ea0d9c">Copy the customization file to the web front-end</h3>

<p>The xml customization file needs to be placed the &lt;sharepoint install root&gt;\12\Config directory and it needs to be named webconfig.&lt;custom name&gt;.xml where <custom name> is a name specified to your customization.</p>

<p>You can take a look at the 12\Config directory to see examples of web.config customizations that are applied by SharePoint and MOSS. You will see that you can not only add nodes to the web.config but also remove or update nodes that exist in the web.config file.</p>

  </div>
  
  <footer>
    <ul class="pager">
      <li class="next"><a href="http://clintsimon.com/post/2008/2008-08-16-Customize-the-web.config-with-a-SharePoint-customization/">Read more <span aria-hidden="true">&raquo;</span></a></li>
    </ul>
  </footer>
  
</article>

  
  <hr/>
  <article>
  <header>
    <h2><a href="http://clintsimon.com/post/2008/2008-04-03-Anonymous-access-and-item-level-permissions/">Anonymous access and item level permissions</a></h2>
    <div class="post-meta clearfix">
      <div class="post-date pull-left">
        Posted on
        <time datetime="2008-04-03T08:00:00-08:00">
          Apr 3, 2008
        </time>
      </div>
    </div>
  </header>
  <div>
    <p>You are probably familiar with the fact that SharePoint now has the capability to host site with anonymous access turned on. I learned the hard way that item level permissions do not participate in the anonymous access behavior the way you might expect. When an item <strong>does not</strong> inherit permissions, it is not possible to enable anonymous access on that item.
Note the document library permission settings menu:</p>

<div class="vinette">
<img src="/images/sp1.png" />
</div>

<p>Here&rsquo;s the same menu for an item which is not inheriting permissions from the parent library:</p>

<div class="vinette">
<img src=" /images/sp2.png" />
</div>

<p>I found an <a href="http://yvonneharryman.wordpress.com/2007/11/23/follow-up-on-anonymous-access-and-item-level-permissions-from-sharepoint-connections-07/">interesting post</a> that quotes <a href="http://blogs.msdn.com/thomriz/">Tom Rizzo</a> on the subject. He explains that this behavior is by design and due to the fact that the product team feels that it is important that anonymous access setting should always cascade and child node should never have a higher degree of anonymous access than it&rsquo;s parent.</p>

  </div>
  
  <footer>
    <ul class="pager">
      <li class="next"><a href="http://clintsimon.com/post/2008/2008-04-03-Anonymous-access-and-item-level-permissions/">Read more <span aria-hidden="true">&raquo;</span></a></li>
    </ul>
  </footer>
  
</article>

  
  <hr/>
  <article>
  <header>
    <h2><a href="http://clintsimon.com/post/2008/2008-03-13-Custom-Field-control-implemented-as-a-User-Control/">Custom Field control implemented as a User Control</a></h2>
    <div class="post-meta clearfix">
      <div class="post-date pull-left">
        Posted on
        <time datetime="2008-03-13T08:00:00-08:00">
          Mar 13, 2008
        </time>
      </div>
    </div>
  </header>
  <div>
    <p>When creating custom controls it is often must easier to create a control using
the &ldquo;User Control&rdquo; development model instead of the &ldquo;Server Control&rdquo; model. <a href="http://msdn.microsoft.com/en-us/library/zt27tfhy.aspx">Server controls</a> generally have a more &ldquo;low level&rdquo; feel and dictate that the developer build the control&rsquo;s rendering from scratch. Either by building a control tree or by constructing the rendered output in code.</p>

<p>Alternatively <a href="http://msdn.microsoft.com/en-us/library/y6wb1a0e.aspx">user controls</a> have nice separation of code and presentation by virtue of having a markup file (.ascx) and a code behind file; much like a standard aspx page. User controls can be created and developed using the same standard approaches and processes that we all know and love from the aspx page model.</p>

<p>When implementing a custom field control for SharePoint, the development experience can be streamlined to a large degree by utilizing a user control. Traditionally field controls are created using the server control model but with a few tricks you can implement a custom field control with a user control.</p>

<p>First, here is the base class used for the field control. It has a virtual property used to set the user control path. A property override for the value of the field which is read from the user control. On initialization it loads the user control and sets the context.</p>

<script src="https://gist.github.com/csim/10280829.js?file=BaseFieldControl.cs"></script>

<p>Here&rsquo;s an example field control subclass. This class simply specifies the user control path and let&rsquo;s the base class handle all the details of loading the user control and setting the context. This is the server control that you will embed into you page layouts.</p>

<script src="https://gist.github.com/csim/10280829.js?file=UserControlFieldBase.cs"></script>

<p>Next, is the abstract base class for the user control. This class provides a property for a reference to the parent field control and an abstract property for the field value. The field control property is important because our user control will need to know all the information about the field it is attached to. This includes the SPField context and control mode among other things.</p>

<script src="https://gist.github.com/csim/10280829.js?file=SPFieldUserControlBase.cs"></script>

<p>Lastly you can create a user control that inherits from the SPFieldUserControlBase class and implement the specific UI that is necessary for you field control to function. See my pervious post on how to create a custom field control for further direction on creating field controls from scratch.
This technique also you to have easiest possible development process while leveraging the SharePoint field control infrastructure. Any questions or comments, please let me know!</p>

  </div>
  
  <footer>
    <ul class="pager">
      <li class="next"><a href="http://clintsimon.com/post/2008/2008-03-13-Custom-Field-control-implemented-as-a-User-Control/">Read more <span aria-hidden="true">&raquo;</span></a></li>
    </ul>
  </footer>
  
</article>

  
  <hr/>
  <article>
  <header>
    <h2><a href="http://clintsimon.com/post/2008/2008-01-07-SharePoint-Custom-Application-Development-Methodologies/">SharePoint Custom Application Development Methodologies</a></h2>
    <div class="post-meta clearfix">
      <div class="post-date pull-left">
        Posted on
        <time datetime="2008-01-07T08:00:00-08:00">
          Jan 7, 2008
        </time>
      </div>
    </div>
  </header>
  <div>
    

<p>As SharePoint becomes more prevalent in the custom application development realm, there has been some friction and malcontent expressed in relation to deployment processes, team development methods and application upgrade paths. I believe that Microsoft has fallen short on providing the tools necessary to promote and support custom application development on the SharePoint platform.</p>

<p>In my opinion, the SharePoint platform should not limit nor impede my ability as a custom application developer to deliver solutions that follow the same deployment principals as any other custom asp.net application. As some readers may be aware, at present the standard Microsoft guidance is flawed because it does not fully support repeatable build processes. This is a huge barrier for custom application developers who are accustom to building applications using source control for all assets, build automation and continuous integration. SharePoint as a lot to offer but taking advantage of the platform as a vehicle for custom applications should be more congruent with standard software development practices.</p>

<h3 id="the-microsoft-approach:eef21bfca27a4a657aef9dd8922e15d2">The Microsoft approach</h3>

<p>The Microsoft approach dictates that for team development environments, artifacts such as aspx, html, css files or any other file that lives in the content database should be created, stored and version controlled in a SharePoint authoring environment. These artifacts are created and maintained by &ldquo;content developers&rdquo;. These content developers use SharePoint designer to create and propagate changes to production.</p>

<p>In parallel, custom application developers are to use standard team development principals (source control, etc) to create assemblies that are then promoted to the authoring environment where they are tested and eventually deployed to the production environment.</p>

<p>Read more:
<a href="http://msdn2.microsoft.com/en-us/library/bb428899.aspx">http://msdn2.microsoft.com/en-us/library/bb428899.aspx</a></p>

<h3 id="where-the-microsoft-approach-falters:eef21bfca27a4a657aef9dd8922e15d2">Where the Microsoft approach falters</h3>

<p>The primary problem with the Microsoft approach is that in many cases there is a <em>hard dependency</em> between artifacts and assemblies. You need to have the same version of artifacts and assemblies to be able to test in any environment and it is not possible get a synchronized version of both sets of assets from a single source. This relegates developers to constantly migrating and updating both content and assemblies to get a consistent version to test. The problem is only compounded because content authors may not be technically able to update assemblies in the authoring environment.</p>

<p>For a custom application of any complexity you need to be able to build and deploy a set of files that work as a unit. For a standard data-driven (SQL Server) asp.net application that means you would have your database creation scripts in source control and when deploying to a new environment (or upgrading an environment), you would run your scripts to create a new copy of the database for that environment. This way, deploying to a test environment becomes easy because you have a repeatable process. Why treat a SharePoint site any differently? You will of course need to use the SharePoint API instead of a SQL database creation script, but the basic function is the same.</p>

<h2 id="a-solution:eef21bfca27a4a657aef9dd8922e15d2">A Solution</h2>

<p>After working with SharePoint for 6+ years I have found that it is possible to treat a SharePoint custom application as you would any other asp.net custom application. The Microsoft tools (and therefore the approach) fall short on these topics but with some motivation and know-how you can achieve substantial benefits by following these steps:</p>

<h3 id="use-spdeploy-http-rapid-tools-googlecode-com:eef21bfca27a4a657aef9dd8922e15d2">Use <a href="http://rapid-tools.googlecode.com">SPDeploy</a></h3>

<p>Ok, this is shamefully self promotional. What I really mean is that you should be using a deployment tool that can support creating customizations inside Visual Studio and deploying those customization via a SharePoint Solution Package (.wsp) to a remote server. There are a few tools that compile a wsp from Visual Studio such as WSPBuilder or Andrew Connell&rsquo;s custom approach. In my opinion SPDeploy is the most complete and easily repeatable solution to solve this problem, but I am biased :)</p>

<h3 id="create-all-your-sharepoint-customizations-inside-visual-studio:eef21bfca27a4a657aef9dd8922e15d2">Create all your SharePoint customizations inside Visual Studio.</h3>

<p>We are custom application developers and we use Visual Studio solutions. This should not change when you are working on a SharePoint project.</p>

<h3 id="use-source-control:eef21bfca27a4a657aef9dd8922e15d2">Use source control</h3>

<p>Because we now have all of our SharePoint customizations inside Visual Studio, the next logical step is to commit that solution to source control. Read more about the benefits of source control:
<a href="http://msdn2.microsoft.com/en-us/library/ms173539.aspx">http://msdn2.microsoft.com/en-us/library/ms173539.aspx</a></p>

<h3 id="design-your-solution-to-provision-all-site-collection-assets-from-source-control:eef21bfca27a4a657aef9dd8922e15d2">Design your solution to provision all site collection assets from source control</h3>

<p>Provisioning all site collection assets enables you to create your projects site collection from source control at will. This means that when a new developer steps onto your project, he or she can pull a copy of the files from source control and create a site collection that is identical to your site collection. Furthermore because you now have a repeatable site collection provisioning process, when deploying to test you can hand-off your wsp and have a tester create a site instance in no time at all.</p>

<p>Implementing this can be a bit tricky. For a brute force approach you can create a feature that lives at the site level that will provision all sub sites, files, etc. Or if you are adventurous you can create an XML configurable feature that will provision all assets according to a configurable XML file.</p>

<h3 id="use-developer-isolated-environments:eef21bfca27a4a657aef9dd8922e15d2">Use developer isolated environments</h3>

<p>Because we have the infrastructure in place to provision all site collection assets, it is possible to create isolated developer environments. This is the standard development method for any asp.net application and it should not change when developing a custom application on top of SharePoint.</p>

<h3 id="use-continuous-integration:eef21bfca27a4a657aef9dd8922e15d2">Use continuous integration</h3>

<p>This one is somewhat optional but I would strongly recommend using continuous integration on any project. Because of the previous points, continuous integration for a SharePoint project becomes possible. Read more about continuous integration:
<a href="http://en.wikipedia.org/wiki/Continuous_integration">http://en.wikipedia.org/wiki/Continuous_integration</a></p>

<h3 id="use-sharepoint-designer-only-as-a-immediate-feedback-tool:eef21bfca27a4a657aef9dd8922e15d2">Use SharePoint Designer only as a &ldquo;Immediate Feedback&rdquo; tool</h3>

<p>SharePoint designer should not be used as a primary development tool (as MS suggests) but rather as a tool to quickly and conveniently see changes inside your site instance. Once you are happy with a change, then it should be placed in your Visual Studio solution so that it can participate in source control.</p>

<p>This is usually helpful with rendering assets such as page layouts, XML files, XSLT transforms and stylesheets. It sure is nice to be able to see changes immediately, but be sure to commit your changes to your Visual Studio project (and hence source control) so that they are visible to other developers on the project.</p>

  </div>
  
  <footer>
    <ul class="pager">
      <li class="next"><a href="http://clintsimon.com/post/2008/2008-01-07-SharePoint-Custom-Application-Development-Methodologies/">Read more <span aria-hidden="true">&raquo;</span></a></li>
    </ul>
  </footer>
  
</article>

  
</section>
  </main>
  <footer class="container global-footer">
    <div class="copyright-note pull-left">
      &copy; Copyright
    </div>
    <div class="sns-links hidden-print">
  
  
  <a href="https://twitter.com/clintsim" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  <a href="https://facebook.com/csim74" target="_blank">
    <i class="fa fa-facebook"></i>
  </a>
  
  
  <a href="https://github.com/csim" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  <a href="https://linkedin.com/in/clintsimon" target="_blank">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  <a href="/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>

  </footer>

  <script src="http://clintsimon.com/js/highlight.pack.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-25860409-1', 'auto');
    ga('send', 'pageview');
  </script>
  
  
</body>
</html>


